syntax = "proto3";
package admin;
option go_package = "github.com/qliquiz/sso/api/gen/admin;admin";

service AdminService {
  rpc ListUsers(ListUsersRequest) returns (ListUsersResponse);
  rpc GetUser(GetUserRequest) returns (GetUserResponse);
  rpc UpdateUser(UpdateUserRequest) returns (UpdateUserResponse);
  rpc DeleteUser(DeleteUserRequest) returns (DeleteUserResponse);

  rpc AssignRole(AssignRoleRequest) returns (AssignRoleResponse);
  rpc RevokeRole(RevokeRoleRequest) returns (RevokeRoleResponse);

  rpc GrantPermission(GrantPermissionRequest) returns (GrantPermissionResponse);
  rpc RevokePermission(RevokePermissionRequest) returns (RevokePermissionResponse);
}

message User {
  string id = 1;
  string email = 2;
  repeated string roles = 3;
  repeated string permissions = 4;
}

message ListUsersRequest {}
message ListUsersResponse {repeated User users = 1;}

message GetUserRequest {string user_id = 1;}
message GetUserResponse {User user = 1;}

message UpdateUserRequest {
  string user_id = 1;
  optional string email = 2;
  optional bool disabled = 3;
}
message UpdateUserResponse {User user = 1;}

message DeleteUserRequest {string user_id = 1;}
message DeleteUserResponse {}

message AssignRoleRequest {string user_id = 1; string role = 2;}
message AssignRoleResponse {}

message RevokeRoleRequest {string user_id = 1; string role = 2;}
message RevokeRoleResponse {}

message GrantPermissionRequest {string user_id = 1; string permission = 2;}
message GrantPermissionResponse {}

message RevokePermissionRequest {string user_id = 1; string permission = 2;}
message RevokePermissionResponse {}
