syntax = "proto3";
package auth;
option go_package = "github.com/qliquiz/sso/api/gen/auth;auth";

service MFAService {
  rpc EnableMFA(EnableMFARequest) returns (EnableMFAResponse);
  rpc VerifyMFA(VerifyMFARequest) returns (VerifyMFAResponse);
  rpc DisableMFA(DisableMFARequest) returns (DisableMFAResponse);
}

message EnableMFARequest {string user_id = 1;}
message EnableMFAResponse {
  string secret = 1; // для генерации QR
  string qr_code_base64 = 2;
}

message VerifyMFARequest {string user_id = 1; string code = 2;}
message VerifyMFAResponse {bool success = 1;}

message DisableMFARequest {string user_id = 1;}
message DisableMFAResponse {}
